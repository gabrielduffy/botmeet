services:
  whisperlive-cpu:
    build:
      context: .
      dockerfile: services/WhisperLive/Dockerfile.cpu
    environment:
      - REDIS_STREAM_URL=redis://default:412trocar@sortebem_redisbot:6379/0/transcription_segments
      - REDIS_URL=redis://default:412trocar@sortebem_redisbot:6379/0
      - DEVICE_TYPE=cpu
      - WHISPER_MODEL_SIZE=base

  bot-manager:
    build:
      context: .
      dockerfile: services/bot-manager/Dockerfile
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - REDIS_URL=redis://default:412trocar@sortebem_redisbot:6379/0
      - BOT_IMAGE_NAME=vexa-bot:latest
      - DOCKER_NETWORK=easypanel-sortebem
      - DOCKER_HOST=unix://var/run/docker.sock
      - DEVICE_TYPE=cpu
      - WHISPER_LIVE_URL=ws://whisperlive-cpu:9090/ws
      - DB_HOST=sortebem_postgresbot
      - DB_PORT=5432
      - DB_NAME=bot
      - DB_USER=bot
      - DB_PASSWORD=412trocar
      - ADMIN_TOKEN=benemax_bot_secure_token_2026

networks:
  default:
    name: easypanel-sortebem
    external: true
